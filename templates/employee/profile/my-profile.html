{% extends "base_company_admin.html" %}
{% load static %}
{% load company_admin_tags %}

{% block title %} 
Employee Profile
{% endblock title %}
{% load widget_tweaks %}

{% block stylesheets %}
<style>
    .card-2 {
        display: flex;
        flex-direction: column;
        gap: 20px;
    }

    .card-2 .card-link  {
        color: #000;
        font-size: 20px;
        text-decoration: none;
        width: 100% !important;
        display: flex;
    }


	.modal-header {
		border: none;
		}
		.modal-footer {
			border: none;
		}
		button.btn.btn-secondary {
		background-color: #188AE2;
		color: #FEFEFC;
		font-family: Inter;
		font-size: 24px;
		font-weight: 700;
		padding: 10px 15px;
		border: none;
		border-radius: 5px;
		margin-right: 20px;
		}
		
		.modal-footer {
		text-align: center;
		display: block;
		}
		.delete-confirmation-modal .icon-alert {
			border-radius: 50px;
			width: 77px;
			height: 77px;
			text-align: center;
			display: flex;
			align-items: center;
			justify-content: center;
			margin: 1.25em auto 1.875em;
			border: .25em solid #facea8;
			color: #f8bb86;
		}
		.modal-header {
		text-align: center;
		padding-bottom:0px;
		display: block;
		}
		
		.delete-confirmation-modal #exampleModalLongTitle {
			text-align: center;
			font-weight: 600;
			color: #595959;
			font-size: 30px;
			margin: 0 0 .4em;
		}
			.delete-confirmation-modal .modal-dialog.modal-dialog-centered {
				margin: 0 auto;
				max-width: 32em;
		}
		.delete-confirmation-modal .modal-content {
			padding: 1.25em;
		}
		.delete-confirmation-modal.modal .modal-content {
			-webkit-border-radius: 0.3125em;
			-moz-border-radius: 0.3125em;
			-ms-border-radius: 0.3125em;
			-o-border-radius: 0.3125em;
			border-radius: 0.3125em;
		}
		.delete-confirmation-modal.modal  .modal-header {
			border-bottom: none;
			padding: 0;
		}
		.delete-confirmation-modal.modal .modal-body {
			text-align: center;
			font-size: 1.125em;
			font-weight: 400;
			color: #545454;
			line-height: normal;
			padding: 0;
		}
		.delete-confirmation-modal.modal #deleteConfirmed {
		border-radius: 0.25em;
		background: initial;
		display: inline-block;
		background-color: rgb(221, 51, 51);
		border-left-color: rgb(221, 51, 51);
		border-right-color: rgb(221, 51, 51);
		color: #fff;
		font-size: 1.0625em;
		margin: 0.3125em;
		padding: 0.625em 2em;
		box-shadow: none;
		font-weight: 500;
		}
		.delete-confirmation-modal.modal #deleteConfirmed:hover {
			background-image: linear-gradient(rgba(0,0,0,.1),rgba(0,0,0,.1));
		}
		.delete-confirmation-modal .modal-footer button.btn {
			display: inline-block;
			background-color: rgb(158, 158, 158, .2);
			border: 0;
			border-radius: 0.25em;
			color: #000000;
			font-size: 1.0625em;
			margin: 0.3125em;
			padding: 0.625em 2em;
			box-shadow: none;
			font-weight: 500;
		}
		.delete-confirmation-modal .modal-footer button.btn:hover {
			background-image: linear-gradient(rgba(0,0,0,.1),rgba(0,0,0,.1));
		}
		.delete-confirmation-modal .modal-content .modal-footer {
			border: 0;
			padding: 0;
			margin: 1.25em auto 0;
		}
		.delete-confirmation-modal {
			padding: .625em !important;
		}   
        .profile-userpic-2 img {
            border: 3px solid rgb(210, 214, 222);
            margin: auto;
            width: 248px;
            height: 164px;
            max-width: 100%;
        } 
    
</style>
{% endblock stylesheets %}
{% block content %}

<div class="page-bar">
    <div class="page-title-breadcrumb">
        <div class=" pull-left">
            <div class="page-title">Employee profile</div>
        </div>
        <ol class="breadcrumb page-breadcrumb pull-right">
           
            <li><a class="parent-item" href="{% url 'employee:employee_profile' %}">Employee</a>&nbsp;<i class="fa fa-angle-right"></i>
            </li>
            
            {% if request.resolver_match.url_name == 'employee_profile' %}
            <li class="active">My profile</li>
            {% elif request.resolver_match.url_name == 'employee_documents' %}
            <li class="active">My documents</li>
            {% elif request.resolver_match.url_name == 'employee_document' %}
            <li><a class="parent-item" href="{% url 'employee:employee_documents' %}">My documents</a>&nbsp;<i class="fa fa-angle-right"></i>
            </li>
            <li class="active">Edit</li>
            {% else  %}
            <li class="active">My clients</li>
            {% endif %}
        </ol>
    </div>
</div>
<div class="row">
{% if messages %}
<div class="container-fluid">
    <ul class="list-unstyled">
    {% for message in messages %}
        <li class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        </li>
    {% endfor %}
    </ul>
</div>
<script>
    // Automatically close alerts after 5 seconds
    window.setTimeout(function () {
        $(".alert").fadeTo(500, 0).slideUp(500, function () {
        $(this).remove();
        });
    }, 5000);
    </script>
{% endif %}
    <div class="col-md-12">
        
        <!-- BEGIN PROFILE SIDEBAR -->
        <div class="profile-sidebar">

        
        </div>
        <!-- END BEGIN PROFILE SIDEBAR -->
        <!-- BEGIN PROFILE CONTENT -->
        <div class="profile-content">
       
            <div class="row">
                <div class="col-md-12">
                    <!-- BEGIN PROFILE SIDEBAR -->
                    <div class="profile-sidebar">
                        <div class="card card-topline-aqua">
                            <div class="card-body no-padding height-9">
                                <div class="row">
                                    <div class="profile-userpic">
                                        {%  if profile.person.profile_image  %}
                                        <img src="{{profile.person.profile_image.url}}" class="img-responsive" alt="">
                                        {% else%}
                                            <img src="{% static 'admin/img/user.png' %}" class="img-responsive" alt="">
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="profile-usertitle">
                                    <div class="profile-user-title">Personal details
                                    </div>
                                </div>
                                <div class="user-details">
                                    <div class="user-info">
                                        <p class="user-profile-content">First
                                            name<span>{% if profile.person.first_name %}{{profile.person.first_name}}{% endif %}</span></p>
                                        <p class="user-profile-content">Last
                                            name<span>{% if profile.person.last_name %}{{profile.person.last_name}}{% endif %}</span></p>
                                        <p class="user-profile-content">Date of
                                            birth<span>
                                                {% if profile.date_of_birth %}{{profile.date_of_birth}}{% endif %}<span></span></span></p>
                                        <p class="user-profile-content">
                                            Gender<span>{% if profile.person.gender %}{{profile.person.gender}}{% endif %}</span></p>
                                    </div>
                                </div>
                                <!-- END SIDEBAR USER TITLE -->

                            </div>

                        </div>
                        <div class="card">
                            <div class="card-head card-topline-aqua">
                                <header>Contact info</header>
                            </div>
                            <div class="card-body no-padding height-9">
                                <div class="row  m-t-10">
                                    <div class="col-md-12">
                                        <div class="user-details">
                                            <div class="user-info">
                                                <p class="user-profile-content">Email<span>{% if profile.person.email %}{{profile.person.email}}{% endif %}</span>
                                                </p>
                                                <p class="user-profile-content">Phone
                                                    number<span>{% if profile.person.phone_number %}{{profile.person.phone_number}}{% endif %}</span></p>
                                                <p class="user-profile-content">Address<span>{% if profile.address %}{{profile.address}}{% endif %}</span></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- END BEGIN PROFILE SIDEBAR -->
                    <!-- BEGIN PROFILE CONTENT -->
                    <div class="profile-content">
                        <div class="row">
                            <div class="card" style="width: 100%;">
                                <div class="card-topline-aqua">
                                    <header></header>
                                </div>
                                <div class="white-box ">
                                    <!-- Nav tabs -->
                                    <div class="p-rl-20">
                                        {% include 'employee/profile/includes/tabs-bar.html' %}
                                    </div>
                                    <!-- Tab panes -->
                                    <div class="tab-content">


                                        {% if request.resolver_match.url_name == 'employee_profile' %}

                                        <div class="tab-pane active fontawesome-demo">
                                            <div class="row">
                                                <div class="col-md-12 p-5">
                                                    <div class="user-details">
                                                        <div class="user-info">
                                                            <p class="user-profile-content">
                                                                Permission set<span>
                                                                    {% if profile.template  %}
                                                                    {{profile.template.name|split_string}}
                                                                    {% endif %}

                                                                </span></p>
                                                                <p class="user-profile-content">
                                                                    Employment type<span>
                                                                        {{profile.employment_type}}
                                                                    </span></p>
                                                            <p class="user-profile-content">
                                                                Approved by admin<span>
                                                                    {% if profile.person.is_active %}
                                                                    Yes
                                                                    {% else %}
                                                                    No
                                                                    {% endif %}
                                                                </span></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            {% if request.user|has_permission:'userauth.update_team_employees' or request.user|has_permission:'userauth.update_all_employees' or  request.user|has_permission:'userauth.update_own_employees' %}
                                            <div class="row">
                                                    <div class="col-lg-12 mt-5 text-center">
                                                        <a href="{% url 'employee:employee_profile_edit' profile.id %}"
                                                            class="btn btn-primary btn-xs" id="editBtn">
                                                            Edit</i>
                                                        </a>
                                                    </div>
                                                </div>
                                            {% endif %}
                                        </div>

                                        {% endif %}
                                        
                                        {% if request.resolver_match.url_name == 'employee_documents' %}
                                        <div class="tab-pane active fontawesome-demo">
                                            <div class="container-fluid">
                                                <div class="row">
                                                    <div id="accordion" style="width: 100%;">
            
                                                        <div class="card-2">
                                                            <div class="card-header">
                                                                <a class="card-link" data-toggle="collapse" href="#collapseOne">
                                                                    IDs and checks
                                                                </a>
                                                            </div>
                                                            <div id="collapseOne" class="collapse show" data-parent="#accordion">
                                                            
                                                        
                                                        <div class="card-body ">
                        
                                                                    <div class="table-scrollable">
                                                                        <table
                                                                            class="table table-striped table-bordered table-hover table-checkable order-column valign-middle"
                                                                            id="">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th>S.no</th>
                                                                                    <th>Document name</th>
                                                                                    <th>Expiry date</th>
                                                                                    <th>Status</th>
                                                                                    <th>Action</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>

                                                                                {% for document in documents_info %}
                                                                                <tr class="odd">
                                                                                    <td>{{ forloop.counter }}</td>
                                                                                    <td>{{ document.name }}</td>
                                                                                    <td>{% if document.expiry_date %}{{ document.expiry_date }}{% endif %}</td>
                                                                                    <td>     
                                                                                        {% if document.status == 'Pending' %} Pending {% endif %}
                                                                                        {% if document.status == 'Approved' %} Approved {% endif %}
                                                                                        {% if document.status == 'Reject' %} Reject {% endif %}
                                                                                    </td>
                                                                                    <td>
                                                                                        <div class="d-flex">
                                                                                        {% if document.file %}
                                                                                            <a href="{{ document.file }}" target="_blank" class="btn btn-primary btn-xs" style="height: fit-content;">
                                                                                                <i class="fa fa-eye"></i>
                                                                                            </a>
                                                                                        {% endif %}
                                                                                        {% if request.user|has_permission:'employee.delete_all_documents' or  request.user|has_permission:'employee.delete_team_documents' or request.user|has_permission:'employee.delete_own_documents' %}
                                                                                        {% if document.id and document.status == 'Pending' %}
                                                                                            <form id="deleteForm_{{ document.id }}" action="{% url 'employee:delete-employee_document' document.employee_id document.id %}" method="post">
                                                                                                {% csrf_token %}
                                                                                                <button type="button" class="btn btn-danger btn-xs" onclick="confirmDelete('{{ document.id }}')" data-toggle="modal" data-target="#deleteConfirmationModal">
                                                                                                    <i class="fa fa-trash-o"></i>
                                                                                                </button>
                                                                                                <input type="hidden" value="outer_delete_request" name = 'employee_profile'>
                                                                                            </form>
                                                                                        {% endif %}
                                                                                        {% endif %}

                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            {% endfor %}
                                                                               
                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        <div class="card-2">
                                                            <div class="card-header ">
                                                            <a class="collapsed card-link" data-toggle="collapse" href="#collapseTwo">
                                                                Qualification
                                                            </a>
                                                            </div>
                                                            <div id="collapseTwo" class="collapse" data-parent="#accordion">
                                                            <div class="card-body ">
                        
                                                                    <div class="table-scrollable">
                                                                        <table
                                                                            class="table table-striped table-bordered table-hover table-checkable order-column valign-middle"
                                                                            id="">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th>S.no</th>
                                                                                    <th>Document name</th>
                                                                                    <th>Expiry date</th>
                                                                                    <th>Status</th>
                                                                                    <th>Action</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                {% for document in qualifications_info %}
                                                                                <tr class="odd">
                                                                                    <td>{{ forloop.counter }}</td>
                                                                                    <td>{{ document.name }}</td>
                                                                                    <td>{% if document.expiry_date %}{{ document.expiry_date }}{% endif %}</td>
                                                                                    <td>
                                                                                        {% if document.status %}
                                                                                            {% if document.status == 'Pending' %} Pending {% endif %}
                                                                                            {% if document.status == 'Approved' %} Approved {% endif %}
                                                                                            {% if document.status == 'Reject' %} Reject {% endif %}
                                                                                        {% endif %}
                                                                                    </td>
                                        

                                                                                    <td>
                                                                                        <div class="d-flex">
                                                                                        {% if document.file %}
                                                                                            <a href="{{ document.file }}" target="_blank" class="btn btn-primary btn-xs" style="height: fit-content;">
                                                                                                <i class="fa fa-eye"></i>
                                                                                            </a>
                                                                                        {% endif %}
                                                                                        {% if request.user|has_permission:'employee.delete_all_documents' or  request.user|has_permission:'employee.delete_team_documents' or request.user|has_permission:'employee.delete_own_documents' %}

                                                                                        {% if document.id and document.status == 'Pending' %}
                                                                                            <form id="deleteForm_{{ document.id }}" action="{% url 'employee:delete-employee_document' document.employee_id document.id %}" method="post">
                                                                                                {% csrf_token %}
                                                                                                <button type="button" class="btn btn-danger btn-xs" onclick="confirmDelete('{{ document.id }}')" data-toggle="modal" data-target="#deleteConfirmationModal">
                                                                                                    <i class="fa fa-trash-o"></i>
                                                                                                </button>
                                                                                                <input type="hidden" value="outer_delete_request" name = 'employee_profile'>

                                                                                            </form>
                                                                                        {% endif %}
                                                                                        {% endif %}

                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            {% endfor %}                                                                     </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
            
                                                        <div class="card-2">
                                                            <div class="card-header ">
                                                                <a class="collapsed card-link" data-toggle="collapse" href="#collapseThree">
                                                                    Other
                                                                </a>
                                                            </div>
                                                            <div id="collapseThree" class="collapse" data-parent="#accordion">
                                                            <div class="card-body ">
                        
                                                                    <div class="table-scrollable">
                                                                        <table
                                                                            class="table table-striped table-bordered table-hover table-checkable order-column valign-middle"
                                                                            id="">
                                                                            <thead>
                                                                                <tr>
                                                                                    <th>S.no</th>
                                                                                    <th>Document name</th>
                                                                                    <th>Expiry date</th>
                                                                                    <th>Status</th>
                                                                                    <th>Action</th>
                                                                                </tr>
                                                                            </thead>
                                                                            <tbody>
                                                                                {% for document in other_documents_info %}
                                                                                <tr class="odd">
                                                                                    <td>{{ forloop.counter }}</td>
                                                                                    <td>{{ document.name }}</td>
                                                                                    <td>{% if document.expiry_date %}{{ document.expiry_date }}{% endif %}</td>
                                                                                    <td>
                                                                                        {% if document.status %}
                                                                                            {% if document.status == 'Pending' %} Pending {% endif %}
                                                                                            {% if document.status == 'Approved' %} Approved {% endif %}
                                                                                            {% if document.status == 'Reject' %} Reject {% endif %}
                                                                                        {% endif %}
                                                                                    </td>
                                                                                    <td>
                                                                                        <div class="d-flex">
                                                                                        {% if document.file %}
                                                                                            <a href="{{ document.file }}" target="_blank" class="btn btn-primary btn-xs" style="height: fit-content;">
                                                                                                <i class="fa fa-eye"></i>
                                                                                            </a>
                                                                                        {% endif %}
                                                                                        {% if request.user|has_permission:'employee.delete_all_documents' or  request.user|has_permission:'employee.delete_team_documents' or request.user|has_permission:'employee.delete_own_documents' %}

                                                                                        {% if document.id  and document.status == 'Pending'%}
                                                                                            <form id="deleteForm_{{ document.id }}" action="{% url 'employee:delete-employee_document' document.employee_id document.id %}" method="post" class="disable-on-submit">
                                                                                                {% csrf_token %}
                                                                                                <button type="button" class="btn btn-danger btn-xs" onclick="confirmDelete('{{ document.id }}')" data-toggle="modal" data-target="#deleteConfirmationModal">
                                                                                                    <i class="fa fa-trash-o"></i>
                                                                                                </button>
                                                                                                <input type="hidden" value="outer_delete_request" name = 'employee_profile'>

                                                                                            </form>
                                                                                        {% endif %}
                                                                                        {% endif %}

                                                                                        </div>
                                                                                    </td>
                                                                                </tr>
                                                                            {% endfor %}

                                                                            </tbody>
                                                                        </table>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
            
                                                        </div>
            
                                                    </div>
            
                                                  </div>  
                                                <div class="row">
                                                    <div class="col-lg-12 mt-5 text-center">
                                                    {% if is_edit %}
                                                     <a href="{% url 'employee:employee_document' employee_id %}"
                                                                                        class="btn btn-primary btn-xs" id="editBtn"> 
                                                                                        Edit</i>
                                                        </a> 
                                                        {% endif %}
                                                    </div>
                                                    
                                                </div>

                                            </div>
                                        </div>
                                        {% endif %}

                                            
                                        {% if request.resolver_match.url_name == 'employee_document' %}
                                        <div class="tab-pane active fontawesome-demo">
                                            <div class="container-fluid">
                                                <!-- <div class="row"> -->

                                                    <div class="tab-pane active">
                                                        <form action="{% url 'employee:employee_document' employee_id %}" method="POST", enctype="multipart/form-data" class="disable-on-submit" >
                                                        {% csrf_token %}
                                    
                                                        <div class="row">
                                                            <div class="col-sm-12">
                                                                <div class="card-box">
                                                                    <div class="card-body">
                                    
                                                                        <div class="row">
                                                                            <div id="accordion" style="width: 100%;">
                                                    
                                                                                <div class="card-2">
                                                                                    <div class="card-header">
                                                                                        <a class="card-link" data-toggle="collapse" href="#collapseOne">
                                                                                            IDs and checks
                                                                                        </a>
                                                                                    </div>
                                                                                    <div id="collapseOne" class="collapse show" data-parent="#accordion">
                                                                                        <div class="card-body row">
                                                                                            <div class="col-lg-4 p-t-20">
                                                                                                <div
                                                                                                    class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                    <h4 class="our-profile-info">Document name</h4>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="col-lg-4 p-t-20">
                                                                                                <div
                                                                                                    class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                    <h4 class="our-profile-info">Expiry date </h4>
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="col-lg-4 p-t-20">
                                                                                                <div
                                                                                                    class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width text-center">
                                                                                                    <h4 class="our-profile-info">Upload </h4>
                                                                                                </div>
                                                                                            </div>
                                                                                            {{ idschecksformset.management_form }}
                                                                                            {% for form in idschecksformset.forms %}
                                                                                            {% render_field form.id %}
                                                                                            {% render_field form.employee %}
                                                                                            {% render_field form.status %}

                                                                                          <div class="col-lg-4 p-t-20">
                                                                                                <div
                                                                                                    class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                        {% render_field form.name class="mdl-textfield__input" %}
                                                                                                        
                                                    
                                                    
                                                                                                </div>
                                                                                            </div>
                                                                                            <div class="col-lg-4 p-t-20">
                                                                                                <div
                                                                                                    class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                    {% render_field form.expiry_date class="mdl-textfield__input" %}
                                                                                                </div>
                                                                                            </div>
                                    
                                                                                            <div class="col-lg-4 p-t-20 file_id" >
                                                                                                <div
                                                                                                    class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width text-center our-profile-upload-file">
                                                                                                  
                                                                                                    {% if form.initial.id %}
                                                                                                        <a href="{{form.initial.file.url}}" target="_blank" class="btn btn-primary btn-xs">
                                                                                                            <i class="fa fa-eye"></i>
                                                                                                        </a>
                                                                                                        {% if request.user|has_permission:'employee.delete_all_documents' or  request.user|has_permission:'employee.delete_team_documents' or  request.user|has_permission:'employee.delete_own_documents' %}
                                                                                                        {% if form.status.value == 'Pending' %}
                                                                                                        <button type="button" class="btn btn-danger btn-xs" onclick="detailconfirmDelete('{{ employee_id }}', '{{ form.initial.id }}')">
                                                                                                            <i class="fa fa-trash-o"></i>
                                                                                                        </button>
                                                                                                        {% endif %}

                                                                                                        {% endif %}
                                                                                                    
                                                                                                        {% else %} 
                                    
                                                                                                        {% render_field form.file class="mdl-textfield__input hidden" onchange="IDgetCurrentfile(this)" accept=".pdf" %}
                                                                                                        <label
                                                                                                        class="btn btn-round btn-success" for="id_idschecks-{{ forloop.counter0 }}-file">Upload</label>
                                                                                                        <p id="ids_checks-div-{{ forloop.counter0 }}"></p>
                                                                                                    {% endif %}  
                                                                                                </div>
                                                                                                
                                    
                                                                                            </div> 
                                    
                                                                                        
                                                                                            {% endfor %}
                                    
                                                                                            
                                                    
                                                                                        </div>
                                                                                    </div>
                                                                                    
                                                                                    <div class="card-2">
                                                                                        <div class="card-header ">
                                                                                            <a class="collapsed card-link" data-toggle="collapse" href="#collapseTwo">
                                                                                                Qualification
                                                                                            </a>
                                                                                        </div>
                                                                                      
                                                                                        <div id="collapseTwo" class="collapse" data-parent="#accordion">
                                                                                            
                                                                                            <div class="card-body row">
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                        <h4 class="our-profile-info">Document name</h4>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                        <h4 class="our-profile-info">Expiry date </h4>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width text-center">
                                                                                                        <h4 class="our-profile-info">Upload </h4>
                                                                                                    </div>
                                                                                                </div>
                                    
                                    
                                    
                                    
                                                                                                {{ qualificationFormSet.management_form }}
                                    
                                                                                                {% for form in qualificationFormSet.forms %}
                                                                                                {% render_field form.id %}
                                                                                                {% render_field form.status %}

                                                                                                {% render_field form.employee %}
                                    
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                            {% render_field form.name class="mdl-textfield__input" %}
                                                    
                                                    
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                        {% render_field form.expiry_date class="mdl-textfield__input" %}
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width text-center">
                                                                                                        {% if form.initial.id %}
                                                                                                        <a href="{{form.initial.file.url}}" target="_blank" class="btn btn-primary btn-xs">
                                                                                                            <i class="fa fa-eye"></i>
                                                                                                        </a>
                                    
                                                                                                      
                                                                                                        {% if request.user|has_permission:'employee.delete_all_documents' or  request.user|has_permission:'employee.delete_team_documents' or  request.user|has_permission:'employee.delete_own_documents' %}
                                                                                                        {% if form.status.value == 'Pending' %}

                                                                                                        <button type="button" class="btn btn-danger btn-xs" onclick="detailconfirmDelete('{{ employee_id }}', '{{ form.initial.id }}')">
                                                                                                            <i class="fa fa-trash-o"></i>
                                                                                                        </button>
                                                                                                        {% endif %}
                                                                                                        {% endif %}
                                                                                        
                                                                                                    
                                                                                                        {% else %} 
                                    
                                                                                                        {% render_field form.file class="mdl-textfield__input hidden" onchange="QualificationgetCurrentfile(this)" accept=".pdf" %}
                                                                                                        <label
                                                                                                        class="btn btn-round btn-success" for="id_qualification-{{ forloop.counter0 }}-file">Upload</label>
                                                                                                        <p id="qualification_checks-div-{{ forloop.counter0 }}"></p>
                                     
                                                                                                       {% endif %}
                                                                                                          
                                                                                                    </div>
                                                                                                </div>
                                                                                                {% endfor %}
                                    
                                                                                            </div>
                                                                                        </div>
                                    
                                                                                    </div>
                                    
                                    
                                                                                    <div class="card-2">
                                                                                        <div class="card-header ">
                                                                                            <a class="collapsed card-link" data-toggle="collapse" href="#collapseThree">
                                                                                                Other
                                                                                            </a>
                                                                                        </div>
                                                                                        <div id="collapseThree" class="collapse" data-parent="#accordion">
                                                                                            <div class="card-body row">
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                        <h4 class="our-profile-info">Document name</h4>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                        <h4 class="our-profile-info">Expiry date </h4>
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width text-center">
                                                                                                        <h4 class="our-profile-info">Upload </h4>
                                                                                                    </div>
                                                                                                </div>
                                    
                                    
                                    
                                                                                                {{ otherFormSet.management_form }}
                                    
                                                                                                {% for form in otherFormSet.forms %}
                                                                                                {% render_field form.employee %}
                                                                                                {% render_field form.status %}

                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                            {% render_field form.name class="mdl-textfield__input" %}
                                    
                                                    
                                                    
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width">
                                                                                                        {% render_field form.expiry_date class="mdl-textfield__input" %}
                                                                                                    </div>
                                                                                                </div>
                                                                                                <div class="col-lg-4 p-t-20">
                                                                                                    <div
                                                                                                        class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label txt-full-width text-center">
                                    
                                                                                                        {% if form.initial.id %}
                                                                                                        <a href="{{form.initial.file.url}}" target="_blank" class="btn btn-primary btn-xs">
                                                                                                            <i class="fa fa-eye"></i>
                                                                                                        </a>
                                    
                                                                                                      
                                                                                                        {% if request.user|has_permission:'employee.delete_all_documents' or  request.user|has_permission:'employee.delete_team_documents' or  request.user|has_permission:'employee.delete_own_documents' %}
                                                                                                        {% if form.status.value == 'Pending' %}

                                                                                                        <button type="button" class="btn btn-danger btn-xs" onclick="detailconfirmDelete('{{ employee_id }}', '{{ form.initial.id }}')">
                                                                                                            <i class="fa fa-trash-o"></i>
                                                                                                        </button>
                                                                                                        {% endif %}
                                                                                                        {% endif %}
                                                                                                    
                                                                                                        {% else %} 
                                    
                                                                                                        {% render_field form.file class="mdl-textfield__input hidden" onchange="OthergetCurrentfile(this)" accept=".pdf" %}
                                                                                                        <label
                                                                                                        class="btn btn-round btn-success" for="id_other-{{ forloop.counter0 }}-file">Upload</label>
                                                                                                        <p id="other_checks-div-{{ forloop.counter0 }}"></p>
                                    
                                                                                                         {% endif %}
                                                                                                    </div>
                                                                                                </div>
                                    
                                                                                                {% endfor %}
                                                                                                
                                                    
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                    
                                                                            </div>
                                                    
                                                                        </div>
                                                                    </div>
                                                                    <!-- </div> -->
                                                                    <div class="col-lg-12 p-t-20 text-center">
                                                                        <button type="submit"
                                                                            class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect m-b-10 m-r-20 btn-blue">Submit</button>
                                                                    <a href="{% url 'employee:employee_documents' %}" class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect m-b-10 btn-default" id="cancelBtn">Cancel</a>
                                    
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>
                                                    </div> 
                                                <!-- </div> -->
                                            </div>
                                        </div>
                                        {% endif %}
                                        {% if request.resolver_match.url_name == 'my_clients' %}
                                      
                            <div class="tab-pane active">
                                <div class="container-fluid">
                                    <div class="row">
                                        <div class="table-scrollable">
                                                            <table
                                                                class="table table-striped table-bordered table-hover table-checkable order-column valign-middle"
                                                                id="">
                                                                <thead>
                                                                    <tr>
                                                                        <th>S.no</th>
                                                                        <th>Client name</th>
                                                                        {% if request.user|has_permission:'userauth.read_all_clients' or request.user|has_permission:'userauth.read_team_clients' or request.user|has_permission:'company_admin.create_all_risk_assessments' or request.user|has_permission:'company_admin.create_risk_assessments_team_own' or request.user|has_permission:'company_admin.create_risk_assessments_of_their_own'  or  request.user|has_permission:'company_admin.read_all_risk_assessments' or  request.user|has_permission:'company_admin.read_risk_assessments_team_own' or  request.user|has_permission:'company_admin.read_risk_assessments_of_their_own' or request.user|has_permission:'company_admin.view_progress_notes_all' or request.user|has_permission:'company_admin.view_incident_own' or request.user|has_permission:'company_admin.view_progress_notes_own' or request.user|has_permission:'company_admin.view_progress_notes_own_team' or request.user|has_permission:'company_admin.view_progress_notes_all'  or request.user|has_permission:'company_admin.view_incident_all' or request.user|has_permission:'company_admin.view_incident_own_team' %}
                                                                        
                                                                        <th>Action</th>
                                                                        {% endif %}
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
         
                                                                    {% if client_details %}
                                                                    {% for client in client_details %}
                                                                    <tr class="odd">
                                                                        <td>{{ forloop.counter }}</td>
                                                                        <td>{{client.person.first_name}}</td>
                                                                        {% if request.user|has_permission:'userauth.read_all_clients' or request.user|has_permission:'userauth.read_team_clients' or request.user|has_permission:'company_admin.create_all_risk_assessments' or request.user|has_permission:'company_admin.create_risk_assessments_team_own' or request.user|has_permission:'company_admin.create_risk_assessments_of_their_own'  or  request.user|has_permission:'company_admin.read_all_risk_assessments' or  request.user|has_permission:'company_admin.read_risk_assessments_team_own' or  request.user|has_permission:'company_admin.read_risk_assessments_of_their_own' or request.user|has_permission:'company_admin.view_progress_notes_all' or request.user|has_permission:'company_admin.view_incident_own' or request.user|has_permission:'company_admin.view_progress_notes_own' or request.user|has_permission:'company_admin.view_progress_notes_own_team' or request.user|has_permission:'company_admin.view_progress_notes_all'  or request.user|has_permission:'company_admin.view_incident_all' or request.user|has_permission:'company_admin.view_incident_own_team' %}
                                                                        <td><a href="{% url 'employee:client_detail_view' client.id  %}"
                                                                            class="btn btn-primary btn-xs" id="viewBtn-{{client.id}}">
                                                                            View
                                                                        </a></td>
                                                                        {% endif %}
                                                                    </tr>
                                                                    {% endfor %}
                                                                    {% else %}
                                                                    <tr class="odd">
                                                                        <td colspan="3">
                                                                        No clients found
                                                                    </td>
                                                                    </tr>
                                                                    {% endif%}

                                                                </tbody>
                                             </table>
                                        </div>
                                    </div>
                                </div>
                            </div>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- END PROFILE CONTENT -->
            </div>
        </div>
        <!-- END PROFILE CONTENT -->	
    </div>
</div>

<!---delete confirm popup-->
<div class="modal fade delete-confirmation-modal" id="deleteConfirmationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <div class="icon-alert">
                <i class="fa fa-exclamation" style="font-size:48px;color:#FFC2A0;"></i>
                </div>
                <h2 class="modal-title" id="exampleModalLongTitle">Are you sure?</h2>
            </div>
            <div class="modal-body">
                You won't be able to revert it!
            </div>
            <div class="modal-footer">
                <button type="button" class="btn" id="deleteConfirmed">Yes, delete it!</button>
                <button type="button" class="btn" data-dismiss="modal" id="deleteCanceled">Cancel</button>
            </div>
        </div>
    </div>
</div>

        <!---delete confirm popup-->
        <div class="modal fade delete-confirmation-modal" id="detaildeleteConfirmationModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="icon-alert">
                    <i class="fa fa-exclamation" style="font-size:48px;color:#FFC2A0;"></i>
                    </div>
                    <h2 class="modal-title" id="exampleModalLongTitle">Are you sure?</h2>
                </div>
                <div class="modal-body">
                    You won't be able to revert it!
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn mdl-button mdl-js-button mdl-button--raised " id="detaildeleteConfirmed">Yes, delete it!</button>
                    <button type="button" class="mdl-button mdl-js-button ml-2 mdl-button--raised  btn-default" data-dismiss="modal">Cancel</button>
                </div>
            </div>
        </div>
    </div>
    
<!--pop up end-->
{% endblock %}
<!--pop up end-->

{% block javascripts %}
<!-- <script>
    function confirmDelete(document_id) {
        $('#deleteConfirmationModal').modal('show');
        $('#deleteConfirmed').click(function () {
            $('#deleteForm_' + document_id).submit();
        });
    }
</script> -->
<script>
	const deleteConfirmButton = document.getElementById('deleteConfirmed')
	const deleteCancelButton = document.getElementById('deleteCanceled')

    function confirmDelete(document_id) {
        $('#deleteConfirmationModal').modal('show');
        // $('#deleteConfirmed').click(function () {
        //     $('#deleteForm_' + employeeId).submit();
        // });
		deleteConfirmButton.addEventListener('click',function(){
			 
			deleteConfirmButton.disabled = true;
			deleteConfirmButton.innerHTML = '<span class="loader"></span>';
			$('#deleteForm_' + document_id).submit();
		});
		deleteCancelButton.addEventListener('click',function(){
			 
			deleteCancelButton.disabled = true;
			deleteCancelButton.innerHTML = '<span class="loader cancel-btn"></span>';
			setTimeout(function() {
				deleteCancelButton.disabled = false;
				deleteCancelButton.innerHTML = 'Cancel'; 
				$('#deleteConfirmationModal').modal('hide');
			}, 500);
			
		});
		
    }
</script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        var fileInput = document.getElementById("id_profile_image");
        var currentFileContainer = document.getElementById("currentFileContainer");

        fileInput.addEventListener("change", function() {
            if (fileInput.files.length > 0) {
                currentFileContainer.textContent = "Currently selected file: " + fileInput.files[0].name;
            } else {
                currentFileContainer.textContent = "No file selected";
            }
        });
    });
</script>

<script>
document.addEventListener("DOMContentLoaded", function() {
    var clearCheckboxes = document.querySelectorAll('input[type="checkbox"][name$="-file-clear"]');
    var clearLabels = document.querySelectorAll('label[for$="-file-clear_id"]');
    
    clearCheckboxes.forEach(function(checkbox) {
        checkbox.remove();
    });
    
    clearLabels.forEach(function(label) {
        label.remove();
    });
});

</script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        var textareas = document.querySelectorAll('textarea[id^="id_"]');
        textareas.forEach(function(textarea) {
            autoExpand(textarea);
        });
    });
    
    function autoExpand(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = (textarea.scrollHeight + 2) + 'px';
    }
    </script>

    <script>
        function detailconfirmDelete(emp_id, document_id) {
            $('#detaildeleteConfirmationModal').modal('show');
    
            $('#detaildeleteConfirmed').click(function () {
                $.ajax({
                    url: '/my-profile/document/delete/' + emp_id + '/' + document_id + '/',
                    method: 'POST',
                    headers: {
                        'X-CSRFToken': '{{ csrf_token }}'
                    },
                    success: function (response) {
                        window.location.reload(); 
                    },
                    error: function (xhr, status, error) {
                        console.error(xhr.responseText);
                    }
                });
            });
        }
    </script>
    <script>
        function IDgetCurrentfile(input) {
            var file = input.files[0];
            var inputId = input.id;
            var numericPart = inputId.match(/\d+/)[0];
            var IdChecks = "ids_checks-div-" + numericPart; 
            var idcheck = document.getElementById(IdChecks);            
            if (idcheck) {
                idcheck.innerHTML = "Current Selected File: " + file.name;
            }
        }
        function QualificationgetCurrentfile(input) {
            var file = input.files[0];
            var inputId = input.id;
            var numericPart = inputId.match(/\d+/)[0];
            var IdChecks = "qualification_checks-div-" + numericPart; 
            var idcheck = document.getElementById(IdChecks);            
            if (idcheck) {
                idcheck.innerHTML = "Current Selected File: " + file.name;
            }
        }

        function OthergetCurrentfile(input) {
            var file = input.files[0];
            var inputId = input.id;
            var numericPart = inputId.match(/\d+/)[0];
            var IdChecks = "other_checks-div-" + numericPart; 
            var idcheck = document.getElementById(IdChecks);            
            if (idcheck) {
                idcheck.innerHTML = "Current Selected File: " + file.name;
            }
        }
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
        const editBtn = document.getElementById('editBtn')

        editBtn.addEventListener('click',function() {
             
            editBtn.disabled = true;
            editBtn.innerHTML = '<span class="loader edit-btn"></span>';
            setTimeout(() => {
                editBtn.disabled = false;
                editBtn.innerHTML = 'Edit';
            }, 300);
        });
    });
    </script>
    
    <!-- <script>
        const viewBtn = document.getElementById('viewBtn')
        viewBtn.addEventListener('click',function() {
             
            viewBtn.disabled = true;
            viewBtn.innerHTML = '<span class="loader edit-btn"></span>';
        });

    </script> -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const viewButtons = document.querySelectorAll('[id^="viewBtn-"]');
            
            viewButtons.forEach(button => {
                button.addEventListener('click', function() {
                    this.disabled = true;
                    this.innerHTML = '<span class="loader edit-btn"></span>';
                    setTimeout(() => {
                        this.disabled = false;
                        this.innerHTML = 'View';
                    }, 300);
                });
            });
        });
                
    </script>
    

{% endblock javascripts %}
